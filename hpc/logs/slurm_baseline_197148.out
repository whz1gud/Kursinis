Running Baseline Evaluation...
Job ID: 197148
Node: node-38
Tue Dec 30 21:47:01 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 550.144.03             Driver Version: 550.144.03     CUDA Version: 12.4     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-SXM2-32GB           On  |   00000000:06:00.0 Off |                    0 |
| N/A   31C    P0             42W /  300W |       1MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+

======================================================================
BASELINE EVALUATION - DINOv2 (No Fine-tuning)
======================================================================

Device: cuda
GPU: Tesla V100-SXM2-32GB

----------------------------------------------------------------------
Step 1: Loading DINOv2 model...
----------------------------------------------------------------------
Loading DINOv2 backbone: dinov2_vits14...
Downloading: "https://github.com/facebookresearch/dinov2/zipball/main" to /scratch/lustre/home/vymi9180/.cache/torch/hub/main.zip
Downloading: "https://dl.fbaipublicfiles.com/dinov2/dinov2_vits14/dinov2_vits14_pretrain.pth" to /scratch/lustre/home/vymi9180/.cache/torch/hub/checkpoints/dinov2_vits14_pretrain.pth
Backbone weights frozen.
Model created: dinov2_vits14 -> 128D embeddings

----------------------------------------------------------------------
Step 2: Loading datasets...
----------------------------------------------------------------------
[load_groundtruth] Loaded 10000 query-reference pairs from data/dev_queries_groundtruth.csv
[DISC21EvalDataset] Found 50000 images in data/queries_dev
[DISC21EvalDataset] Found 50000 images in data/refs

----------------------------------------------------------------------
Step 3: Extracting embeddings...
----------------------------------------------------------------------

Extracting query embeddings...
  Shape: (50000, 128)

Extracting reference embeddings...
  Shape: (50000, 128)

Total extraction time: 754.7s

----------------------------------------------------------------------
Step 4: Computing metrics...
----------------------------------------------------------------------
Computing similarity matrix...
  Precision@1: 0.5633
  Precision@5: 0.6125
  Precision@10: 0.6238
  Precision@50: 0.6673
  Precision@100: 0.6862
  mAP: 0.5850
  uAP: 0.4187

----------------------------------------------------------------------
Step 5: Saving results...
----------------------------------------------------------------------
Results saved to: results/baseline_results.json

======================================================================
BASELINE RESULTS SUMMARY
======================================================================

Metric                    Score
------------------------------
P@1                      0.5633
P@5                      0.6125
P@10                     0.6238
P@50                     0.6673
P@100                    0.6862
mAP                      0.5850
uAP                      0.4187
------------------------------

[OK] Baseline evaluation complete!
     These results represent DINOv2 performance WITHOUT fine-tuning.
     After training with different loss functions, we'll compare against these.
Baseline evaluation complete!
